
<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADMIN - FC RADIO DALAM</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@500;700&family=Rajdhani:wght@500;600;700&family=Teko:wght@400;600&display=swap" rel="stylesheet">
    
    <style>
        /* === STYLE PREMIUM GOLD & BLACK === */
        :root { 
            --bg: #000; 
            --panel: #111; 
            --border: #333; 
            --gold: #FFD700; 
            --gold-dark: #B8860B;
            --red: #D90429; 
            --green: #2b9348;
            --blue: #0088FF;
            
            --font-main: 'Oswald', sans-serif;
            --font-tech: 'Rajdhani', sans-serif;
            --font-num: 'Teko', sans-serif;
        }
        
        body { 
            background: #000; color: #ddd; font-family: var(--font-tech); padding: 10px; font-size: 13px; margin: 0; 
            background-image: radial-gradient(circle at top, #1a1500 0%, #000000 80%);
            min-height: 100vh;
        }
        
        .adm-header { 
            display: flex; align-items: center; justify-content: space-between; 
            margin-bottom: 20px; border-bottom: 1px solid var(--gold); padding-bottom: 15px; 
        }
        
        .box { 
            border: 1px solid #333; padding: 15px; margin-bottom: 15px; 
            background: #0a0a0a; border-radius: 6px; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.5); 
        }
        
        h3 { 
            margin: 0 0 15px 0; color: var(--gold); 
            border-bottom: 1px solid #333; padding-bottom: 5px; 
            font-family: var(--font-main); font-size: 16px; letter-spacing: 1px; 
            display: flex; justify-content: space-between; align-items: center; 
        }
        
        /* BUTTONS */
        button { 
            cursor: pointer; padding: 8px 15px; font-weight: bold; 
            font-family: var(--font-main); font-size: 14px; letter-spacing: 0.5px; 
            border-radius: 4px; transition: 0.2s; border: none; text-transform: uppercase; 
        }
        button:active { transform: scale(0.95); }
        
        .btn-gold { background: linear-gradient(45deg, var(--gold-dark), var(--gold)); color: #000; border: 1px solid var(--gold); }
        .btn-red { background: linear-gradient(45deg, #900, #d00); color: #fff; border: 1px solid #f00; }
        .btn-green { background: linear-gradient(45deg, #050, #090); color: #fff; border: 1px solid #0f0; }
        .btn-blue { background: #222; color: #aaa; border: 1px solid #444; } 
        .btn-mini { padding: 4px 8px; font-size: 12px; margin: 2px; }

        input, select { 
            background: #151515; color: var(--gold); border: 1px solid #444; 
            padding: 10px; border-radius: 4px; font-family: var(--font-num); font-size:16px; 
            width: 100%; box-sizing: border-box; margin-bottom:5px; text-transform: uppercase; 
        }
        
        /* TABLE */
        table { width: 100%; border-collapse: collapse; margin-top: 5px; font-size: 12px; }
        td, th { border-bottom: 1px solid #222; padding: 8px; text-align: left; vertical-align: middle; }
        th { color: var(--gold); text-transform: uppercase; font-size: 11px; letter-spacing: 1px; font-family: var(--font-main); }
        tr:nth-child(even) { background: rgba(255,255,255,0.02); }

        /* GRID 3 SLOT */
        .slot-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .slot-item { 
            border: 1px solid #333; padding: 10px; background: #050505; text-align: center; 
            border-radius: 6px; min-height: 120px; display: flex; flex-direction: column; 
            justify-content: space-between; position: relative; overflow: hidden; 
        }
        .slot-item.active { border-color: var(--gold); background: rgba(255, 215, 0, 0.05); }
        
        /* BADGE */
        .adm-badge { font-size: 10px; padding: 2px 6px; border-radius: 2px; font-weight: bold; display: inline-block; margin-top: 3px; border: 1px solid #333; }
        .bg-gold { background: #000; color: var(--gold); border-color: var(--gold); }
        .bg-guest { background: #222; color: #888; }
        .bg-blocked { background: #300; color: var(--red); border-color: var(--red); }

        /* LOGS */
        .term-container { background: #000; border: 1px solid #333; height: 150px; overflow-y: auto; padding: 10px; font-family: 'Courier New', monospace; font-size: 11px; color: #888; border-radius: 5px; }
        .log-line { margin-bottom: 4px; border-bottom: 1px solid #111; padding-bottom: 2px; }

        /* MODAL */
        #customModal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 9999; justify-content: center; align-items: center; backdrop-filter: blur(5px); }
        .modal-box { background: #111; border: 1px solid var(--gold); width: 85%; max-width: 300px; padding: 25px; border-radius: 8px; text-align: center; }
        .modal-btns { display: flex; gap: 10px; margin-top: 20px; }
        .mb-yes { flex:1; background: var(--gold); color: #000; font-weight:bold; }
        .mb-no { flex:1; background: #333; color: #fff; border: 1px solid #555; }
        
        /* BLACKLIST ITEM */
        .bl-item { display: flex; justify-content: space-between; align-items: center; background: #1a0000; border: 1px solid #500; padding: 8px; margin-bottom: 5px; border-radius: 4px; }
        .bl-plat { font-family: var(--font-num); font-size: 18px; color: var(--red); }

    </style>
</head>
<body>

    <div class="adm-header">
        <div>
            <div style="font-family:var(--font-main); font-size:24px; color:#fff;">ADMIN PANEL</div>
            <div style="font-size:11px; color:var(--gold); letter-spacing:2px;">FC RADIO DALAM â€¢ MLS</div>
        </div>
        <button onclick="window.location.href='system.html'" class="btn-blue" style="font-size:12px;">KE LAYAR DEPAN</button>
    </div>

    <div class="box" style="border-top: 2px solid var(--gold);">
        <h3>LIVE MONITORING (3 NOZZLE)</h3>
        <div class="slot-grid">
            <div id="slot1" class="slot-item">...</div>
            <div id="slot2" class="slot-item">...</div>
            <div id="slot3" class="slot-item">...</div>
        </div>
        
        <div style="margin-top:15px; background:#111; padding:10px; border-radius:5px; display:flex; align-items:center; gap:10px; flex-wrap:wrap;">
            <span style="font-size:11px; color:#666;">TUKAR POSISI:</span>
            <select id="moveSrc" style="padding:5px; width:auto; min-width:80px;">
                <option value="0">NOZZLE 1</option>
                <option value="1">NOZZLE 2</option>
                <option value="2">NOZZLE 3</option>
            </select>
            <span style="color:var(--gold);">âž¡</span>
            <select id="moveDest" style="padding:5px; width:auto; min-width:80px;">
                <option value="1">NOZZLE 2</option>
                <option value="2">NOZZLE 3</option>
                <option value="0">NOZZLE 1</option>
            </select>
            <button onclick="askConfirm('Tukar Posisi User?', moveSlotUser)" class="btn-gold btn-mini">GO</button>
        </div>
    </div>

    <div class="box" style="border-top: 2px solid #fff;">
        <h3>
            DAFTAR ANTRIAN
            <button onclick="askConfirm('URUTKAN ULANG NOMOR DARI 1?', resetTicketNumbers)" class="btn-red btn-mini">â™» RE-INDEX NO</button>
        </h3>
        
        <div id="queueTable" style="max-height:300px; overflow-y:auto; margin-bottom:15px; border:1px solid #222;"></div>
        
        <div style="background:#111; padding:10px; border-radius:5px;">
            <div style="font-size:10px; color:var(--gold); margin-bottom:5px;">FORCE INPUT (VIP/MANUAL)</div>
            <div style="display:flex; gap:5px;">
                <input id="newPlat" placeholder="PLAT (B 1234 XYZ)" style="flex:2;">
                <input id="newNama" placeholder="NAMA" style="flex:2;">
            </div>
            <div style="display:flex; gap:5px; margin-top:5px;">
                <button onclick="manualAdd('queue')" class="btn-green" style="flex:2;">+ KE ANTRIAN</button>
                <button onclick="manualAdd(0)" class="btn-gold" style="flex:1;">N1</button>
                <button onclick="manualAdd(1)" class="btn-gold" style="flex:1;">N2</button>
                <button onclick="manualAdd(2)" class="btn-gold" style="flex:1;">N3</button>
            </div>
        </div>
    </div>
    
    <div class="box" style="border: 1px solid var(--red);">
        <h3 style="color:var(--red);">â›” MANAJEMEN BLOKIR (BLACKLIST)</h3>
        <div style="font-size:10px; color:#888; margin-bottom:10px;">Plat nomor yang diblokir tidak akan bisa mendaftar di sistem.</div>
        
        <div style="display:flex; gap:5px; margin-bottom:15px;">
            <input id="blockInput" placeholder="MASUKKAN PLAT..." style="flex:3;">
            <button onclick="blockUser()" class="btn-red" style="flex:1;">BLOKIR</button>
        </div>
        
        <div style="font-size:10px; color:#aaa; margin-bottom:5px;">DAFTAR TERBLOKIR:</div>
        <div id="blacklistContainer" style="max-height:150px; overflow-y:auto;">
            </div>
    </div>

    <div class="box" style="border: 1px dashed #555;">
        <h3 style="color:#aaa;">EMERGENCY ZONE</h3>
        <div style="display:flex; gap:10px;">
            <button onclick="checkRecovery()" class="btn-blue" style="flex:1;">ðŸ“‚ CEK BACKUP</button>
            <button onclick="askConfirm('RESET TOTAL (KOSONGKAN DATA)?', hardReset)" class="btn-red" style="flex:1;">ðŸ’€ WIPE DATA (0)</button>
        </div>
        <div id="recoveryPanel" style="display:none; margin-top:10px; background:#220000; padding:10px; border:1px solid var(--red);">
            <div id="recList" style="font-size:10px; margin-bottom:10px; color:#fff;"></div>
            <button onclick="executeRestore()" class="btn-green" style="width:100%;">PULIHKAN DATA TERAKHIR</button>
        </div>
    </div>

    <div style="font-size:10px; color:#444; margin-bottom:5px;">SYSTEM LOGS:</div>
    <div class="term-container" id="termLog"></div>

    <div id="customModal">
        <div class="modal-box">
            <h2 style="margin:0 0 10px 0; font-family:var(--font-main); color:var(--gold); font-size:20px;">KONFIRMASI</h2>
            <div id="modalText" style="color:#ccc; margin-bottom:20px; font-size:14px;">Text</div>
            <div class="modal-btns">
                <button id="btnYes" class="mb-yes">YA</button>
                <button onclick="closeModal()" class="mb-no">BATAL</button>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, onSnapshot, runTransaction, collection, addDoc, query, orderBy, limit, getDocs, setDoc, getDoc, updateDoc, arrayUnion, arrayRemove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // === FIREBASE CONFIG FC RADIO DALAM ===
        const firebaseConfig = {
            apiKey: "AIzaSyAAwGboEDOjh57ZP1157SCFxR4LC-DPSeg",
            authDomain: "fc-radio-dalam.firebaseapp.com",
            projectId: "fc-radio-dalam",
            storageBucket: "fc-radio-dalam.firebasestorage.app",
            messagingSenderId: "823688693955",
            appId: "1:823688693955:web:330a75ed8dd445d6137a76"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const mainRef = doc(db, "antrian", "utama");
        const logRef = collection(db, "activityLog");
        const snapshotRef = doc(db, "antrian", "snapshot");

        // DEFAULT 3 SLOTS
        let cachedSlots = [null, null, null];
        let cachedQueue = [];
        let cachedBlacklist = [];
        let snapshotData = null;

        // AUTH
        if(localStorage.getItem('adm_sess')) {} 
        else { 
            let p = prompt("PIN ADMIN:"); 
            if(p==="5678") localStorage.setItem('adm_sess','1'); 
            else { alert("Salah!"); location.href = 'system.html'; } 
        }

        // MODAL
        let currentCallback = null;
        window.askConfirm = (text, callback) => {
            document.getElementById('modalText').innerText = text;
            document.getElementById('customModal').style.display = 'flex';
            currentCallback = callback;
        };
        document.getElementById('btnYes').onclick = () => { if(currentCallback) currentCallback(); closeModal(); };
        window.closeModal = () => { document.getElementById('customModal').style.display = 'none'; currentCallback = null; };

        // === MONITOR ===
        onSnapshot(mainRef, (snap) => {
            if (!snap.exists()) return;
            const d = snap.data();
            // Ensure 3 slots logic
            cachedSlots = d.chargingSlots || [null, null, null];
            while(cachedSlots.length < 3) cachedSlots.push(null);

            cachedQueue = d.waitingQueue || [];
            cachedBlacklist = d.blacklist || []; // LOAD BLACKLIST
            
            updateMonitor();
            updateBlacklistUI();
        });

        function updateMonitor() {
            // UPDATE 3 SLOTS
            cachedSlots.forEach((s, i) => {
                if(i > 2) return;
                const el = document.getElementById(`slot${i+1}`);
                if(s) {
                    let badgeClass = "bg-guest"; let roleText = s.role || "GUEST";
                    if(roleText !== "GUEST") { badgeClass = "bg-gold"; }

                    el.className = "slot-item active";
                    el.innerHTML = `
                        <div>
                            <div style="font-size:24px; font-family:var(--font-num); color:#fff; line-height:1;">${s.plat}</div>
                            <div style="font-size:11px; color:#aaa;">${s.userName}</div>
                            <span class="adm-badge ${badgeClass}">${roleText}</span>
                        </div>
                        <div style="display:grid; gap:5px; width:100%;">
                            <button class="btn-red btn-mini" onclick="askConfirm('STOP / KICK User ini?', ()=>forceStop(${i}))">STOP</button>
                            <button class="btn-blue btn-mini" onclick="askConfirm('Kembalikan ke Antrian?', ()=>kickToQueue(${i}))">TO QUEUE</button>
                        </div>
                    `;
                } else {
                    el.className = "slot-item";
                    el.innerHTML = `<div style="color:#333; margin:auto; font-family:var(--font-main);">KOSONG</div>`;
                }
            });

            // UPDATE QUEUE TABLE
            let h = `<table><tr><th width="30">NO</th><th>PLAT / NAMA</th><th width="100">PINDAH KE</th><th width="50">AKSI</th></tr>`;
            if(cachedQueue.length === 0) h += `<tr><td colspan="4" style="text-align:center; padding:15px; color:#444;">ANTRIAN KOSONG</td></tr>`;
            
            cachedQueue.forEach((q, idx) => {
                let badgeClass = "bg-guest"; let roleText = q.role || "GUEST";
                if(roleText !== "GUEST") badgeClass = "bg-gold";
                
                h += `<tr>
                    <td style="font-size:16px; font-weight:bold; color:var(--gold); font-family:var(--font-num);">${q.qNo}</td>
                    <td><b style="color:#fff; font-size:14px;">${q.plat}</b><br><span style="color:#888; font-size:10px;">${q.userName}</span> <span class="adm-badge ${badgeClass}" style="font-size:8px;">${roleText}</span></td>
                    <td>
                        <div style="display:flex; gap:2px;">
                            <button class="btn-gold btn-mini" onclick="forceToSlot('${q.plat}', 0)">N1</button>
                            <button class="btn-gold btn-mini" onclick="forceToSlot('${q.plat}', 1)">N2</button>
                            <button class="btn-gold btn-mini" onclick="forceToSlot('${q.plat}', 2)">N3</button>
                        </div>
                    </td>
                    <td>
                        <div style="display:flex; gap:2px;">
                            <button class="btn-blue btn-mini" onclick="switchQueue(${idx}, -1)">â¬†</button>
                            <button class="btn-blue btn-mini" onclick="switchQueue(${idx}, 1)">â¬‡</button>
                            <button class="btn-red btn-mini" onclick="askConfirm('Hapus?', ()=>delQueue('${q.plat}'))">X</button>
                        </div>
                    </td>
                </tr>`;
            });
            document.getElementById('queueTable').innerHTML = h + `</table>`;
        }
        
        // === BLACKLIST LOGIC ===
        function updateBlacklistUI() {
            const el = document.getElementById('blacklistContainer');
            el.innerHTML = '';
            if(cachedBlacklist.length === 0) {
                el.innerHTML = '<div style="color:#444; text-align:center; padding:10px;">TIDAK ADA DATA</div>';
                return;
            }
            cachedBlacklist.forEach(plat => {
                const div = document.createElement('div');
                div.className = 'bl-item';
                div.innerHTML = `
                    <div class="bl-plat">${plat}</div>
                    <button class="btn-blue btn-mini" onclick="unblockUser('${plat}')">BUKA BLOKIR</button>
                `;
                el.appendChild(div);
            });
        }
        
        window.blockUser = async () => {
            const p = document.getElementById('blockInput').value.trim().toUpperCase();
            if(!p) return;
            
            if(confirm(`BLOKIR PLAT ${p}?\nUser dengan plat ini tidak akan bisa mendaftar.`)) {
                await updateDoc(mainRef, { blacklist: arrayUnion(p) });
                document.getElementById('blockInput').value = '';
                addLog("ADMIN", "BLOCK", p);
            }
        };
        
        window.unblockUser = async (p) => {
            if(confirm(`Buka blokir ${p}?`)) {
                await updateDoc(mainRef, { blacklist: arrayRemove(p) });
                addLog("ADMIN", "UNBLOCK", p);
            }
        };

        // === FUNCTIONS ===
        window.resetTicketNumbers = () => {
            runTransaction(db, async(t) => {
                const d = (await t.get(mainRef)).data();
                let queue = d.waitingQueue || [];
                queue.forEach((q, index) => { q.qNo = index + 1; });
                t.update(mainRef, { waitingQueue: queue, lastTicket: queue.length });
                addLog("ADMIN", "RESET_NUMBER", `Re-indexed ${queue.length} users`);
            }).then(() => alert("BERHASIL!")).catch(e => alert("Gagal: " + e));
        };

        window.manualAdd = async (target) => {
            const p = document.getElementById('newPlat').value.trim().toUpperCase();
            const n = document.getElementById('newNama').value.trim().toUpperCase();
            if(!p) return alert("Plat Nomor Wajib Diisi!");

            // CEK BLACKLIST
            if(cachedBlacklist.includes(p)) {
                return alert(`GAGAL: PLAT ${p} SEDANG DIBLOKIR!`);
            }

            let userRole = "GUEST";
            const cleanID = p.replace(/[^A-Z0-9]/g, '');
            try {
                let m = await getDoc(doc(db, "members", cleanID));
                if(m.exists()) userRole = m.data().role || "MEMBER";
            } catch(e) {}

            runTransaction(db, async(t) => {
                const docSnap = await t.get(mainRef);
                let d = docSnap.data();
                if(!d.chargingSlots) d.chargingSlots = [null,null,null];
                
                if([...d.chargingSlots, ...d.waitingQueue].some(u => u && u.plat === p)) throw "User sudah ada!";

                const newNo = (d.lastTicket||0)+1;
                const u = { plat:p, userName:n||"MANUAL", qNo:newNo, entryTime:Date.now(), role: userRole };

                if(target === 'queue') d.waitingQueue.push(u); 
                else { 
                    if(d.chargingSlots[target]) throw "Slot Penuh!"; 
                    u.startTime = Date.now(); d.chargingSlots[target] = u; 
                }

                t.set(snapshotRef, { ...d, backupTime: new Date() });
                t.update(mainRef, { waitingQueue:d.waitingQueue, chargingSlots:d.chargingSlots, lastTicket:newNo });
                addLog("ADMIN", "MANUAL_INPUT", `Add ${p}`);
            }).then(() => {
                document.getElementById('newPlat').value = '';
                document.getElementById('newNama').value = '';
            }).catch(e => alert("GAGAL: " + e));
        };

        window.forceToSlot = (plat, slotIdx) => {
            runTransaction(db, async(t) => {
                const d = (await t.get(mainRef)).data();
                if(!d.chargingSlots) d.chargingSlots = [null,null,null];
                if(d.chargingSlots[slotIdx]) throw "SLOT TERISI!";
                const qIdx = d.waitingQueue.findIndex(x => x.plat === plat);
                if(qIdx === -1) throw "User hilang.";
                const user = d.waitingQueue.splice(qIdx, 1)[0];
                user.startTime = Date.now();
                d.chargingSlots[slotIdx] = user;
                t.update(mainRef, { chargingSlots: d.chargingSlots, waitingQueue: d.waitingQueue });
                addLog("ADMIN", "FORCE_SLOT", `${plat} -> N${slotIdx+1}`);
            }).catch(e => alert(e));
        };

        window.forceStop = (i) => {
            runTransaction(db, async(t) => {
                const d = (await t.get(mainRef)).data();
                d.chargingSlots[i] = null;
                t.update(mainRef, { chargingSlots: d.chargingSlots });
                addLog("ADMIN", "STOP", `Slot ${i+1}`);
            });
        };

        window.kickToQueue = (i) => {
            runTransaction(db, async(t) => {
                const d = (await t.get(mainRef)).data();
                const u = d.chargingSlots[i];
                if(u) {
                    d.chargingSlots[i] = null; delete u.startTime; 
                    d.waitingQueue.unshift(u);
                    t.update(mainRef, { chargingSlots: d.chargingSlots, waitingQueue: d.waitingQueue });
                }
            });
        };

        window.moveSlotUser = () => {
            const s1 = document.getElementById('moveSrc').value;
            const s2 = document.getElementById('moveDest').value;
            if(s1 == s2) return alert("Pilih slot beda!");
            runTransaction(db, async(t) => {
                const d = (await t.get(mainRef)).data();
                const temp = d.chargingSlots[s1];
                d.chargingSlots[s1] = d.chargingSlots[s2];
                d.chargingSlots[s2] = temp;
                t.update(mainRef, { chargingSlots: d.chargingSlots });
            });
        };

        window.switchQueue = (idx, dir) => {
            runTransaction(db, async(t) => {
                const d = (await t.get(mainRef)).data();
                let q = d.waitingQueue;
                const target = idx + dir;
                if(target >= 0 && target < q.length) {
                    [q[idx], q[target]] = [q[target], q[idx]];
                    t.update(mainRef, { waitingQueue: q });
                }
            });
        };

        window.delQueue = (p) => {
            runTransaction(db, async(t) => {
                const d = (await t.get(mainRef)).data();
                const newQ = d.waitingQueue.filter(x => x.plat !== p);
                t.update(mainRef, { waitingQueue: newQ });
            });
        };

        // === SNAPSHOT & LOG ===
        window.checkRecovery = async () => {
            const s = await getDoc(snapshotRef);
            if(!s.exists()) return alert("Tidak ada backup.");
            snapshotData = s.data();
            document.getElementById('recList').innerText = `BACKUP: ${snapshotData.backupTime ? snapshotData.backupTime.toDate().toLocaleTimeString() : '-'}`;
            document.getElementById('recoveryPanel').style.display = 'block';
        };

        window.executeRestore = () => {
            if(!snapshotData) return;
            runTransaction(db, async(t) => {
                let rSlots = snapshotData.chargingSlots || [null,null,null];
                while(rSlots.length < 3) rSlots.push(null);
                
                t.set(mainRef, { 
                    chargingSlots: rSlots, 
                    waitingQueue: snapshotData.waitingQueue || [], 
                    lastTicket: snapshotData.lastTicket || 0,
                    blacklist: snapshotData.blacklist || [] // Restore blacklist too
                });
                addLog("ADMIN", "RESTORE", "Restored Snapshot");
            });
            document.getElementById('recoveryPanel').style.display = 'none';
            alert("Data Pulih!");
        };

        window.hardReset = () => {
            runTransaction(db, async(t) => {
                t.set(mainRef, { chargingSlots: [null,null,null], waitingQueue: [], lastTicket: 0, blacklist: [] });
                addLog("ADMIN", "HARD_RESET", "Wiped All Data");
            });
        };

        onSnapshot(query(logRef, orderBy("timestamp", "desc"), limit(20)), (snap) => {
            let h = '';
            snap.forEach(d => {
                const x = d.data();
                h += `<div class="log-line">[${x.timestamp ? x.timestamp.toDate().toLocaleTimeString() : '-'}] <span style="color:var(--gold)">${x.actor}</span>: ${x.action} - ${x.details}</div>`;
            });
            document.getElementById('termLog').innerHTML = h;
        });

        function addLog(actor, act, det) { 
            addDoc(logRef, { action: act, details: det, actor: actor, timestamp: new Date() }); 
        }
    </script>
</body>
</html>
